<body>
  <h1>üõ†Ô∏è PAINEL STAFF</h1>

  <!-- X fixo no canto direito -->
  <button onclick="window.location.href='pagina2.html'" style="
    position: fixed;
    top: 15px;
    right: 20px;
    background: red;
    color: white;
    border: none;
    font-size: 18px;
    font-weight: bold;
    border-radius: 50%;
    width: 30px;
    height: 30px;
    cursor: pointer;
    z-index: 9999;
  ">X</button>

  <div class="painel" id="conteudo-staff"></div>

  <!-- Painel Flutuante -->
  <div class="overlay" id="cargo-overlay">
    <div class="cargo-panel">
      <div class="close-panel" onclick="fecharPainel()">X</div>
      <h3>ADICIONAR CARGOS</h3>
      <input type="text" id="idUsuario" placeholder="ID do Discord">
      <select id="cargoSelecionado">
        <option value="Staff">Staff</option>
        <option value="CEO">CEO</option>
        <option value="Cliente">Cliente</option>
      </select>
      <button onclick="darCargo()">DAR CARGO</button>
      <button onclick="removerCargo()">REMOVER CARGO</button>
      <div class="mensagem" id="mensagemCargo"></div>
    </div>
  </div>

  <script>
    const token = localStorage.getItem("discord_token");
    const CEO_ID = "1358576424180518992";
    const STAFF_ID = "123456789012345678";

    let usuarioLogado;

    if (!token) {
      document.getElementById("conteudo-staff").innerHTML = "<h2>üö´ Voc√™ n√£o est√° logado!</h2>";
    } else {
      fetch("https://discord.com/api/v10/users/@me", {
        headers: { Authorization: `Bearer ${token}` }
      })
      .then(res => res.json())
      .then(user => {
        usuarioLogado = user;
        const autorizado = user.id === CEO_ID || user.id === STAFF_ID;

        if (!autorizado) {
          document.getElementById("conteudo-staff").innerHTML = "<h2>üö´ Acesso negado. Apenas Staff ou CEO pode acessar este painel.</h2>";
        } else {
          document.getElementById("conteudo-staff").innerHTML = `
            <p>Bem-vindo, <strong>${user.global_name || user.username}</strong>!</p>
            <p>Painel exclusivo para gerenciamento.</p>
            <button onclick="abrirPainel()">DAR CARGO</button>
          `;
        }
      })
      .catch(() => {
        document.getElementById("conteudo-staff").innerHTML = "<h2>Erro ao verificar permiss√µes.</h2>";
      });
    }

    function abrirPainel() {
      if (usuarioLogado.id !== CEO_ID) {
        alert("üö´ Apenas o CEO pode abrir o painel de cargos.");
        return;
      }
      document.getElementById("cargo-overlay").style.display = "flex";
    }

    function fecharPainel() {
      document.getElementById("cargo-overlay").style.display = "none";
      document.getElementById("mensagemCargo").textContent = "";
    }

    function darCargo() {
      const id = document.getElementById("idUsuario").value.trim();
      const cargo = document.getElementById("cargoSelecionado").value;

      if (!id) {
        mostrarMensagem("Preencha o ID do usu√°rio.", "orange");
        return;
      }

      const perfil = JSON.parse(localStorage.getItem("perfil_" + id)) || {};
      perfil.cargo = cargo;
      localStorage.setItem("perfil_" + id, JSON.stringify(perfil));

      mostrarMensagem("‚úÖ Cargo atribu√≠do com sucesso!", "lightgreen");
    }

    function removerCargo() {
      const id = document.getElementById("idUsuario").value.trim();

      if (!id) {
        mostrarMensagem("Preencha o ID do usu√°rio.", "orange");
        return;
      }

      const perfil = JSON.parse(localStorage.getItem("perfil_" + id)) || {};
      delete perfil.cargo;
      localStorage.setItem("perfil_" + id, JSON.stringify(perfil));

      mostrarMensagem("‚ùå Cargo removido com sucesso!", "red");
    }

    function mostrarMensagem(msg, cor) {
      const el = document.getElementById("mensagemCargo");
      el.textContent = msg;
      el.style.color = cor;
    }
  </script>
</body>
